webpackJsonp([58],{AnAo:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o("Dd8w"),n=o.n(i),s=o("NYxO"),a=o("6kks"),r=o("hrUx"),d=o("aM/G"),h=null,c={components:{accountNav:a.a,imageTest:r.a},data:function(){return{pageTitle:"",phoneCodePhd:"",imgCodePhd:"",showCodePanel:!1,hasMobile:"",mobile:"",countryCode:"",imgCodeUrl:"",imgCode:"",isError:"",userId:"",errorTip:"",showHint:!1,phoneCode:"",codeDisabled:!1,isGetCode:!1,time:60,phoneCodeError:!1,verifyType:"_0"}},created:function(){this.pageTitle=this.bindPhone.title[0],this.phoneCodePhd=this.bindPhone.placeholder[0],this.imgCodePhd=this.bindPhone.placeholder[1]},watch:{phoneCode:function(){this.phoneCode&&(this.phoneCodeError=!1)}},mounted:function(){var e=this;setTimeout(function(){e.pageInit()},50)},computed:n()({codeText:function(){return this.codeDisabled?this.time+"s":this.isGetCode?this.accountWithdraw.htmlContent[7]:this.accountWithdraw.htmlContent[3]}},Object(s.mapState)({accountWithdraw:function(e){return e.lang.language.accountWithdraw},bindPhone:function(e){return e.lang.language.bindPhone}})),methods:{getCodeVal:function(e){this.imgCode=e},pageInit:function(){var e=this.$f7router.currentRoute.query,t=this.isLogin();if(this.userId=t.id,this.getImgCode(),e.mobile)return this.hasMobile=!0,this.mobile=e.mobile,void(this.countryCode=e.countryCode);this.mobile=t.mobile||"",this.countryCode=t.countryCode||""},countDown:function(e){var t=this;this.time=60,h&&clearInterval(h),h=setInterval(function(){if((e-=1)<=0)return clearInterval(h),void(t.codeDisabled=!1);t.time=e},1e3)},getImgCode:function(){this.imgCodeUrl="/api/user/captcha/image/"+this.userId},affirmImgCode:function(){var e=this,t=[this.imgCode];this.imgCode?Object(d._41)(t).then(function(t){200===t.code?(e.getPhoneCode(),e.isError=!1,e.showCodePanel=!1,e.imgCode=""):(e.reGetCodeImg(),e.imgCode="",e.isError=!0,e.imgCodePhd=t.message)}):this.imgCodePhd=this.bindPhone.remind[4]},getBtn:function(){this.codeDisabled||(this.showCodePanel=!0,this.imgCodeUrl="/api/user/captcha/image/"+this.userId+"?v="+ +new Date,this.imgCode="")},reGetCodeImg:function(){this.imgCodeUrl="/api/user/captcha/image/"+this.userId+"?v="+ +new Date,this.imgCode=""},getPhoneCode:function(){var e=this,t=this;Object(d.O)(this.$refs.getCode,{mobile:t.mobile,areaCode:t.countryCode}).then(function(o){200===o.code&&o.data?("email"===o.data.type&&(t.verifyType="_1"),e.codeDisabled||e.countDown(60),t.showHint=!0,t.codeDisabled=t.isGetCode=!0):t.$vn.toast.show(o.message)})},affirmBind:function(){var e=this;this.phoneCode?this.hasMobile?Object(d.n)(this.$refs.affirmBind,{countryCode:this.countryCode,mobile:this.mobile,captcha:this.phoneCode}).then(function(t){200===t.code?(e.$vn.toast.show(e.bindPhone.alertMessage[0]),setTimeout(function(){e.$f7router.navigate("/accountSet")},2e3)):e.$vn.toast.show(t.message)}):Object(d.r)([this.verifyType,this.phoneCode],this.$refs.affirmBind).then(function(t){200===t.code?e.$f7router.navigate("/alterPhone2"):e.$vn.toast.show(t.message)}):this.phoneCodeError=!0},hintText:function(){this.$vn.alert.show(this.bindPhone.alertMessage[1])}}},l={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("f7-page",{staticClass:"main-body"},[o("account-nav",{attrs:{pageTitle:e.pageTitle}}),e._v(" "),o("div",{staticClass:"scroll-body"},[o("div",{staticClass:"main-place"},[o("div",{staticClass:"message-box"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneCode,expression:"phoneCode"}],class:{"error-red":e.phoneCodeError},attrs:{type:"tel",oninput:"this.value=this.value.replace(/[^\\d]/g,'')",maxlength:"6",placeholder:e.phoneCodePhd},domProps:{value:e.phoneCode},on:{input:function(t){t.target.composing||(e.phoneCode=t.target.value)}}}),e._v(" "),o("span",{ref:"getCode",staticClass:"text-btn",on:{click:e.getBtn}},[e._v(e._s(e.codeText)+" ")]),e._v(" "),o("div",{staticClass:"error-remind"},[o("span",{directives:[{name:"show",rawName:"v-show",value:e.phoneCodeError,expression:"phoneCodeError"}]},[e._v(e._s(e.bindPhone.remind[0]))])]),e._v(" "),o("div",{staticClass:"hint",class:e.showHint?"hint-show":""},[o("p",[e._v(e._s(e.bindPhone.remind[1]))]),e._v(" "),o("span",[e._v(e._s(e.mobile.slice(0,3))+" **** "+e._s(e.mobile.slice(e.mobile.length-4)))])]),e._v(" "),e.hasMobile?e._e():o("p",{staticClass:"phone-hint",on:{click:e.hintText}},[e._v(e._s(e.bindPhone.remind[2])+"\n                    ")])]),e._v(" "),o("span",{ref:"affirmBind",staticClass:"button",on:{click:e.affirmBind}},[e._v(e._s(e.bindPhone.remind[3]))])])]),e._v(" "),o("image-test",{directives:[{name:"show",rawName:"v-show",value:e.showCodePanel,expression:"showCodePanel"}],attrs:{caseUrl:e.imgCodeUrl,isError:e.isError,codeVal:e.imgCode,inputPlaceholder:e.imgCodePhd},on:{changeCaseUrl:e.reGetCodeImg,onConfirm:e.affirmImgCode,codeVal:e.getCodeVal}})],1)},staticRenderFns:[]};var m=o("VU/8")(c,l,!1,function(e){o("hkn+")},"data-v-10365136",null);t.default=m.exports},"hkn+":function(e,t){}});