webpackJsonp([27],{ZxuX:function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t("Dd8w"),s=t.n(o),n=t("NYxO"),a=t("hrUx"),d=t("6kks"),r=t("aM/G"),h=t("pWFc"),l={components:{accountNav:d.a,imageTest:a.a},data:function(){return{pageTitle:"",email:"",phoneCodePhd:"",imgCodePhd:"",showCodePanel:!1,imgCodeUrl:"",imgCode:"",isError:"",userId:"",errorTip:"",showHint:"",codeDisabled:!1,isGetCode:!1,phoneCode:"",phoneCodeError:"",verifyType:"_0",count:"",bindEmailCode:h.f.get("bindEmail")}},computed:s()({codeText:function(){return this.codeDisabled?this.count+"s":this.isGetCode?this.bindEmail.btns[1]:this.bindEmail.btns[0]}},Object(n.mapState)({bindEmail:function(e){return e.lang.language.bindEmail}})),created:function(){this.pageTitle=this.bindEmail.title[0],this.phoneCodePhd=this.bindEmail.placeholder[0],this.imgCodePhd=this.bindEmail.placeholder[1],this.showHint=this.bindEmail.alertMessage[5],this.email=h.f.get("bindEmail")},mounted:function(){this.pageInit()},methods:{getCodeVal:function(e){this.imgCode=e},pageInit:function(){var e=this.isLogin();this.userId=e.id,this.getImgCode()},getImgCode:function(){this.imgCodeUrl="/api/user/captcha/image/"+this.userId},affirmImgCode:function(){var e=this,i=[this.imgCode];this.imgCode?Object(r._46)(i).then(function(i){200===i.code?(e.getPhoneCode(),e.isError=!1,e.showCodePanel=!1,e.imgCode=""):(e.reGetCodeImg(),e.imgCode="",e.isError=!0,e.imgCodePhd=i.message)}):this.imgCodePhd=this.bindEmail.remind[4]},reGetCodeImg:function(){this.imgCodeUrl="/api/user/captcha/image/"+this.userId+"?v="+ +new Date,this.imgCode=""},getBtn:function(){this.codeDisabled||(this.showCodePanel=!0,this.imgCodeUrl="/api/user/captcha/image/"+this.userId+"?v="+ +new Date,this.imgCode="")},getPhoneCode:function(){var e=this,i=this;Object(r.I)(this.$refs.getCode,{email:i.email}).then(function(t){200===t.code&&t.data?(i.$vn.alert.show({text:i.showHint}),e.imgCodePhd=e.bindEmail.remind[4],i.codeDisabled=i.isGetCode=!0,e.countDown(i,function(){i.codeDisabled=!1,i.isGetCode=!0})):i.$vn.toast.show(t.message)})},nextStep:function(){var e=this;""!=this.phoneCode?Object(r.m)(this.$refs.affirmBind,{email:this.bindEmailCode,captcha:this.phoneCode}).then(function(i){200===i.code?(e.$vn.toast.show(e.bindEmail.alertMessage[0]),setTimeout(function(){e.$f7router.navigate("/accountSet")},2e3)):e.$vn.toast.show(i.message)}):this.phoneCodeError=this.bindEmail.remind[9]}}},c={render:function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("f7-page",{staticClass:"main-body"},[t("account-nav",{attrs:{pageTitle:e.pageTitle}}),e._v(" "),t("div",{staticClass:"scroll-body"},[t("div",{staticClass:"main-place"},[t("p",{staticClass:"title"},[e._v(e._s(e.bindEmail.title[1]))]),e._v(" "),t("div",{staticClass:"message-box"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneCode,expression:"phoneCode"}],class:{"error-red":e.phoneCodeError},attrs:{type:"tel",oninput:"this.value=this.value.replace(/[^\\d]/g,'')",maxlength:"6",placeholder:e.phoneCodePhd},domProps:{value:e.phoneCode},on:{input:function(i){i.target.composing||(e.phoneCode=i.target.value)}}}),e._v(" "),t("span",{ref:"getCode",staticClass:"text-btn",on:{click:e.getBtn}},[e._v(e._s(e.codeText)+" ")]),e._v(" "),t("div",{staticClass:"error-remind"},[t("span",{directives:[{name:"show",rawName:"v-show",value:e.phoneCodeError,expression:"phoneCodeError"}]},[e._v(e._s(e.bindEmail.remind[0]))])])]),e._v(" "),t("span",{ref:"affirmBind",staticClass:"button",on:{click:e.nextStep}},[e._v(e._s(e.bindEmail.btns[2]))])])]),e._v(" "),t("image-test",{directives:[{name:"show",rawName:"v-show",value:e.showCodePanel,expression:"showCodePanel"}],attrs:{caseUrl:e.imgCodeUrl,isError:e.isError,codeVal:e.imgCode,inputPlaceholder:e.imgCodePhd},on:{changeCaseUrl:e.reGetCodeImg,onConfirm:e.affirmImgCode,codeVal:e.getCodeVal}})],1)},staticRenderFns:[]};var m=t("VU/8")(l,c,!1,function(e){t("lp+S")},"data-v-9cb88d06",null);i.default=m.exports},"lp+S":function(e,i){}});